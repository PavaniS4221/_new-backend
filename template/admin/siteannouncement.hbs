<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Site Announcements</title>
    <link rel="stylesheet" href="/admin/siteannouncement.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar">
      <img src="../images/nmit-logo.svg" alt="NITTE Logo" class="logo" />
      <div class="nav-icons">
        <a href="/admin/index" class="breadcrumb-link">Home</a>
        <a href="/admin/notification" id="notification-bell">
          <i class="fas fa-bell"></i>
          <span class="notification-count" id="notification-count">0</span>
        </a>
        <a href="/admin/view-profile" class="avatar-circle">
          <i class="fas fa-user"></i>
        </a>
      </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar">
      <a href="/admin/manage_admin">
        <i class="fas fa-user-tie"></i>
        <span>Manage Admin</span>
      </a>
      <a href="/admin/teacherdetails">
        <i class="fas fa-chalkboard-teacher"></i>
        <span>Manage Teacher</span>
      </a>
      <a href="/admin/studentdetails">
        <i class="fas fa-user-graduate"></i>
        <span>Manage Student</span>
      </a>
      <a href="/admin/driverdetails">
        <i class="fas fa-car"></i>
        <span>Manage Driver</span>
      </a>
      <a href="/admin/route">
        <i class="fas fa-route"></i>
        <span>Route List</span>
      </a>
      <a href="/admin/siteannouncement" class="active">
        <i class="fas fa-bullhorn"></i>
        <span>Site Announcements</span>
      </a>
      <a href="/admin/scheduleevent">
        <i class="fas fa-calendar-alt"></i>
        <span>Schedule</span>
      </a>
      <a href="/admin/complaintbox">
        <i class="fas fa-comment-dots"></i>
        <span>Complaint Box</span>
      </a>
      <a href="/admin/seatavailable">
        <i class="fas fa-chair"></i>
        <span>Seat Availability</span>
      </a>
      <a href="/admin/notify">
        <i class="fas fa-bell"></i>
        <span>Admin Notification</span>
      </a>
      <a href="/admin/inquiery">
        <i class="fas fa-question-circle"></i>
        <span>Inquiry</span>
      </a>
      <a href="/admin/payment-records">
        <i class="fas fa-money-bill-wave"></i>
        <span>Payments</span>
      </a>
      <a href="/admin/admlogin">
        <i class="fas fa-sign-out-alt"></i>
        <span>Logout</span>
      </a>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Page Header -->
      <div class="page-header">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h1><i class="fas fa-bullhorn"></i> Site Announcements</h1>
            <p class="mb-0">Manage and broadcast important announcements to
              students, staff, and drivers</p>
          </div>
          <button class="btn btn-light btn-lg" onclick="openCreateModal()">
            <i class="fas fa-plus"></i>
            New Announcement
          </button>
        </div>
      </div>

      <!-- Statistics -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h3 id="totalCount">0</h3>
              <p class="text-muted mb-0">Total Announcements</p>
            </div>
            <i class="fas fa-bullhorn fa-2x text-primary"></i>
          </div>
        </div>
        <div class="stat-card">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h3 id="activeCount">0</h3>
              <p class="text-muted mb-0">Active</p>
            </div>
            <i class="fas fa-check-circle fa-2x text-success"></i>
          </div>
        </div>
        <div class="stat-card">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h3 id="scheduledCount">0</h3>
              <p class="text-muted mb-0">Scheduled</p>
            </div>
            <i class="fas fa-clock fa-2x text-info"></i>
          </div>
        </div>
        <div class="stat-card">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h3 id="urgentCount">0</h3>
              <p class="text-muted mb-0">Urgent</p>
            </div>
            <i class="fas fa-exclamation-triangle fa-2x text-danger"></i>
          </div>
        </div>
      </div>

      <!-- Filters and Search -->
      <div class="filter-section">
        <div class="row g-3">
          <div class="col-md-4">
            <div class="input-group">
              <span class="input-group-text"><i
                  class="fas fa-search"
                ></i></span>
              <input
                type="text"
                class="form-control"
                id="searchInput"
                placeholder="Search announcements..."
              />
            </div>
          </div>
          <div class="col-md-2">
            <select class="form-select" id="priorityFilter">
              <option value="">All Priorities</option>
              <option value="urgent">Urgent</option>
              <option value="high">High</option>
              <option value="medium">Medium</option>
              <option value="low">Low</option>
            </select>
          </div>
          <div class="col-md-2">
            <select class="form-select" id="statusFilter">
              <option value="">All Status</option>
              <option value="active">Active</option>
              <option value="scheduled">Scheduled</option>
              <option value="draft">Draft</option>
            </select>
          </div>
          <div class="col-md-2">
            <select class="form-select" id="categoryFilter">
              <option value="">All Categories</option>
              <option value="emergency">Emergency</option>
              <option value="schedule">Schedule</option>
              <option value="route">Route</option>
              <option value="fee">Fee</option>
              <option value="general">General</option>
            </select>
          </div>
          <div class="col-md-2">
            <button
              class="btn btn-outline-secondary w-100"
              onclick="clearFilters()"
            >
              <i class="fas fa-times"></i>
              Clear
            </button>
          </div>
        </div>
      </div>

      <!-- Announcements List -->
      <div id="announcementsList">
        <!-- Announcements will be loaded here -->
      </div>

      <!-- Empty State -->
      <div id="emptyState" class="empty-state" style="display: none;">
        <i class="fas fa-bullhorn"></i>
        <h4>No Announcements Found</h4>
        <p>Create your first announcement to start communicating with your
          audience.</p>
        <button class="btn btn-primary" onclick="openCreateModal()">
          <i class="fas fa-plus"></i>
          Create Announcement
        </button>
      </div>
    </div>

    <!-- Create/Edit Modal -->
    <div class="modal fade" id="announcementModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTitle">
              <i class="fas fa-bullhorn"></i>
              Create Announcement
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form id="announcementForm">
              <input type="hidden" id="editId" />

              <div class="row g-3">
                <div class="col-12">
                  <div class="form-floating">
                    <input
                      type="text"
                      class="form-control"
                      id="title"
                      placeholder="Title"
                      required
                      maxlength="100"
                    />
                    <label for="title">Announcement Title *</label>
                  </div>
                  <div class="char-counter mt-1">
                    <span id="titleCount">0</span>/100 characters
                  </div>
                </div>

                <div class="col-12">
                  <div class="form-floating">
                    <textarea
                      class="form-control"
                      id="message"
                      placeholder="Message"
                      style="height: 120px"
                      required
                      maxlength="500"
                    ></textarea>
                    <label for="message">Message *</label>
                  </div>
                  <div class="char-counter mt-1">
                    <span id="messageCount">0</span>/500 characters
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-floating">
                    <select class="form-select" id="category" required>
                      <option value="">Select Category</option>
                      <option value="emergency">üö® Emergency</option>
                      <option value="schedule">üìÖ Schedule Change</option>
                      <option value="route">üõ£Ô∏è Route Update</option>
                      <option value="fee">üí∞ Fee Related</option>
                      <option value="maintenance">üîß Maintenance</option>
                      <option value="general">üì¢ General</option>
                    </select>
                    <label for="category">Category *</label>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-floating">
                    <select class="form-select" id="priority" required>
                      <option value="">Select Priority</option>
                      <option value="low">üü¢ Low</option>
                      <option value="medium">üü° Medium</option>
                      <option value="high">üü† High</option>
                      <option value="urgent">üî¥ Urgent</option>
                    </select>
                    <label for="priority">Priority *</label>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-floating">
                    <select class="form-select" id="targetAudience">
                      <option value="all">All Users</option>
                      <option value="students">Students Only</option>
                      <option value="staff">Staff Only</option>
                      <option value="drivers">Drivers Only</option>
                    </select>
                    <label for="targetAudience">Target Audience</label>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="form-floating">
                    <select class="form-select" id="affectedRoutes" multiple>
                      <option value="all" selected>All Routes</option>
                      <option value="route1">Route 1 - Jayanagar</option>
                      <option value="route2">Route 2 - Malleshwaram</option>
                      <option value="route3">Route 3 - Devaiah Park</option>
                      <option value="route4">Route 4 - Yelahanka</option>
                      <option value="route5">Route 5 - Electronic City</option>
                    </select>
                    <label for="affectedRoutes">Affected Routes</label>
                  </div>
                  <small class="text-muted">Hold Ctrl/Cmd to select multiple</small>
                </div>

                <div class="col-12">
                  <label class="form-label">Publish Options</label>
                  <div class="row g-2">
                    <div class="col-md-4">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          name="publishOption"
                          id="publishNow"
                          value="now"
                          checked
                        />
                        <label class="form-check-label" for="publishNow">
                          <i class="fas fa-play"></i>
                          Publish Now
                        </label>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          name="publishOption"
                          id="scheduleLater"
                          value="schedule"
                        />
                        <label class="form-check-label" for="scheduleLater">
                          <i class="fas fa-clock"></i>
                          Schedule Later
                        </label>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          name="publishOption"
                          id="saveDraft"
                          value="draft"
                        />
                        <label class="form-check-label" for="saveDraft">
                          <i class="fas fa-save"></i>
                          Save as Draft
                        </label>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-12" id="scheduleSection" style="display: none;">
                  <div class="row g-2">
                    <div class="col-md-6">
                      <div class="form-floating">
                        <input
                          type="datetime-local"
                          class="form-control"
                          id="publishDate"
                        />
                        <label for="publishDate">Publish Date & Time</label>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-floating">
                        <input
                          type="datetime-local"
                          class="form-control"
                          id="expiryDate"
                        />
                        <label for="expiryDate">Expiry Date & Time</label>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-12">
                  <label class="form-label">Notification Options</label>
                  <div class="row g-2">
                    <div class="col-md-6">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="sendEmail"
                          checked
                        />
                        <label class="form-check-label" for="sendEmail">
                          <i class="fas fa-envelope"></i>
                          Email Notification
                        </label>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="sendPush"
                          checked
                        />
                        <label class="form-check-label" for="sendPush">
                          <i class="fas fa-bell"></i>
                          Push Notification
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              <i class="fas fa-times"></i>
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-outline-primary"
              onclick="saveDraft()"
            >
              <i class="fas fa-save"></i>
              Save Draft
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="saveAnnouncement()"
            >
              <i class="fas fa-paper-plane"></i>
              Publish
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    ></script>
    <script src="/admin/js/siteannouncement.js"></script>
  </body>
</html>