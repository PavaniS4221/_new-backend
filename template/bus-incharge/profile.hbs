<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Profile</title>
  <link rel="stylesheet" type="text/css" href="/dashboard.css">
  <link rel="stylesheet" href="/studentdetails.css">
  <link rel="stylesheet" href="/profile.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/css/all.min.css">
</head>

<body>
  <div class="container-fluid">
    <!-- Navigation -->
    <nav class="navigation">
      <ul>
        <li>
          <a href="/bus-incharge/busincharge-dashboard">
            <span class="title">
              <span class="image-wrapper">
                <img src="../images/logoside.png" alt="Logo">
              </span>
            </span>

            <span class="box">NITTE MEENAKSHI
              INSTITUTE OF TECHNOLOGY</span>

          </a>
        </li>

        <li class="hovered">
          <a href="/bus-incharge/busincharge-dashboard">
            <span class="icon">
              <ion-icon name="home-outline"></ion-icon>
            </span>
            <span class="title">Dashboard</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/studentdetails">
            <span class="icon"><i class="fa fa-graduation-cap" aria-hidden="true"></i></span>
            <span class="title">Student Details</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/staffdetails">
            <span class="icon">
              <ion-icon name="people-outline"></ion-icon>
            </span>
            <span class="title">Staff Details</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/busdetails">
            <span class="icon"><i class="fa fa-bus" aria-hidden="true"></i></span>
            <span class="title">Bus Details</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/share-location">
            <span class="icon">
              <i class="fas fa-location"></i>
            </span>
            <span class="title">Share Location</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/view-all-payments">
            <span class="icon"><i class="fa-solid fa-indian-rupee-sign" aria-hidden="true"></i></span>
            <span class="title">Payment Records</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/announcement">
            <span class="icon"><i class="fa fa-bullhorn" aria-hidden="true"></i></span>
            <span class="title">Announcements</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/schedule">
            <span class="icon"><i class="fa fa-calendar" aria-hidden="true"></i></span>
            <span class="title">View Schedule</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/notify">
            <span class="icon"><i class="fa fa-bell" aria-hidden="true"></i></span>
            <span class="title">Notify Passengers</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/chat">
            <span class="icon">
              <ion-icon name="chatbubble-outline"></ion-icon>
            </span>
            <span class="title">Chat</span>
          </a>
        </li>
        <li>
          <a href="/bus-incharge/inquiry">
            <span class="icon">
              <ion-icon name="help-outline"></ion-icon>
            </span>
            <span class="title">Inquiry</span>
          </a>
        </li>
        <li>
          <a href="/loginform">
            <span class="icon">
              <ion-icon name="log-out-outline"></ion-icon>
            </span>
            <span class="title">Log Out</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- Main Content -->
    <main class="main">
      <header class="topbar">
        <div class="toggle">
          <ion-icon name="menu-outline"></ion-icon>
        </div>
        <div class="right-section">

          <div class="notification-icon" onclick="toggleNotifications()" aria-label="Toggle Notifications">
            ðŸ””<span class="badge" id="notifCount">2</span>
          </div>

          <div class="right-section">
            <div class="user">
              <img src="../images/avatar.png" alt="User Menu" id="avatar" class="avatar"></img></div>
            <div class="collapse-menu" id="collapseMenu">
              <a href="/bus-incharge/profile">View Profile</a>
              <a href="/bus-incharge/logout">Log Out</a>
            </div>

          </div>

        </div>

      </header>
      <div>
        <!-- Notification Dropdown Panel -->
        <div class="notification-panel" id="notificationPanel" style="display: none;">
          <div class="notif-header">
            <h3 id="notifHeader">You have 2 notifications</h3>
            <button class="dclose" onclick="closePanel()">&times;</button>
          </div>

          <div class="notification"
            onclick="openDetails('New Students', 'New student records have been successfully added to the system. Please review the updated student list for further details.')">
            <div class="notification-content">
              <strong>New Students</strong>
              <p>New Students Added</p>
              <div class="notification-right">
                <img src="../images/avatar.png" alt="Profile" class="profile-image"><span class="user-name">
                  <h5>Vanitha</h5>
                </span>
              </div>
            </div>
          </div>

          <div class="notification"
            onclick="openDetails('Fees Amount', 'Kindly Note ! Fees amount for this year increased.Its 35000')">
            <div class="notification-content">
              <strong>Fees Amount</strong>
              <p>Fees amount for this year increased.Its 35000</p>
              <div class="notification-right">
                <img src="../images/avatar.png" alt="Profile" class="profile-image"><span class="user-name">
                  <h5>Priya Darshini</h5>
                </span>
              </div>
            </div>
          </div>

          <a href="/bus-incharge/notification" class="view-all" onclick="showNotificationPageAndClear()">View All</a>
        </div>

        <div class="notification-details" id="notificationDetails" style="display: none;">
          <h2 id="notifTitle">Notification Title</h2>
          <p id="notifDescription">Notification description.</p>
          <button class="dclose" onclick="closeNotification()">&times;</button>
          <button class="n-reply-btn"
            onclick="openReplyPopup(document.getElementById('notifTitle').textContent)">Reply</button>
        </div>
        <!-- Reply Popup -->
        <div class="reply-popup" id="replyPopup" style="display: none;">
          <h2 id="replyTitle">Reply</h2>
          <textarea id="replyMessage" placeholder="Type your message..."></textarea>
          <div class="popup-btn-container">
            <button class="popup-btn n-send-btn" onclick="sendReply()">Send</button>
            <button class="popup-btn n-close-btn" onclick="closeReplyPopup()">Cancel</button>
          </div>
        </div>
      </div>
      <!-- Toast Notification Container -->
      <div id="toast-container"></div>

      <!-- Cards -->
      <div class="student-details">
        <div class="breadcrumb">
          <h2 class="breadcrumb-title">My Profile</h2>
          <a href="/bus-incharge/busincharge-dashboard" class="breadcrumb-link">Home</a>
          <span>/</span>
        </div>

<!--changed as per backend -->
        <form action="/profileupdate" method="POST" enctype="multipart/form-data" id="profileForm">
          <input type="hidden" name="email" value="{{profile.email}}" />
          <input type="hidden" name="fName" id="fNameHidden" value="{{profile.fName}}" />
          <input type="hidden" name="lName" id="lNameHidden" value="{{profile.lName}}" />
  <input type="hidden" name="gender" id="genderHidden" value="{{profile.gender}}" />
  <input type="hidden" name="phone_num" id="phoneNumberHidden" value="{{profile.phone_num}}" />
  <input type="hidden" name="license_num" id="licenseNumberHidden" value="{{profile.license_num}}" />
  <input type="hidden" name="DOB" id="dobHidden" value="{{profile.DOB}}" />
  <input type="hidden" name="joined_date" id="joinedDateHidden" value="{{profile.joined_date}}" />
  <input type="hidden" name="years_of_experience" id="experienceHidden" value="{{profile.years_of_experience}}" />
  <input type="hidden" name="address" id="addressHidden" value="{{profile.address}}" />
  <input type="hidden" name="postal_code" id="postalHidden" value="{{profile.postal_code}}" />
  
 
        <div class="profile-container">

          <!-- Driver Profile -->
          <div class="psection">
            <div class="header">
              <div class="profile-header">
                <div class="image-container">
                  <img id="profilePhoto"  src="{{#if profileImageBase64}}data:{{profileImageType}};base64,{{profileImageBase64}}{{else}}/images/avatar.png{{/if}}" alt="Profile Photo" class="profile-photo" />
                  <input type="file" id="fileInput" accept="image/*" name="profileImage" style="display: none;" />
                  <button type="button" class="edit-icon" onclick="document.getElementById('fileInput').click()">âœŽ</button>
                  <button type="submit" class="save-image-btn" id="saveImageBtn" style="display:none;">ðŸ’¾</button>
                </div>
                <div class="profile-info">
                  <h2 id="driverName">{{profile.fName}} {{profile.lName}}</h2>
                  <p>Route Driver</p>
                  <p>Route Number: <span id="route_num">{{profile.route_num}}</span></p>
                   <input type="hidden" name="route_num" id="route_numHidden" value="{{profile.route_num}}" />
                </div>
              </div>
              <button type="button" class="edit-btn" onclick="editSection(this, ['route_num'])">Edit âœŽ</button>
            </div>
          </div>

        
          <!-- Personal Information -->
          <div class="section">
            <div class="header">
              <span class="section-title">Personal Information</span>
              <button type="button" class="edit-btn"
                onclick="editSection(this, ['gender', 'phoneNumber', 'licenseNumber', 'dob', 'joinedDate', 'experience'])">Edit
                âœŽ</button>
            </div>
            <div class="profile-details" id="personalInfo" >
              <div class="detail-item"><span class="label">Driver ID:</span><span class="value">{{profile.driver_ID}}</span></div>
              <div class="detail-item"><span class="label">Gender:</span><span class="value" id="gender">{{profile.gender}}</span>
              </div>
              <div class="detail-item"><span class="label">Email:</span><span class="value">{{profile.email}}</span>
              </div>
              <div class="detail-item"><span class="label">Phone Number:</span><span class="value"
                  id="phoneNumber">{{profile.phone_num}}</span></div>
              <div class="detail-item"><span class="label">License Number:</span><span class="value"
                  id="licenseNumber">{{profile.license_num}}</span></div>
              <div class="detail-item"><span class="label">Date of Birth:</span><span class="value"
                  id="dob">{{profile.DOB}}</span>
              </div>
              <div class="detail-item"><span class="label">Joined Date:</span><span class="value"
                  id="joinedDate">{{profile.joined_date}}</span></div>
              <div class="detail-item"><span class="label">Years of Experience:</span><span class="value"
                  id="experience">{{profile.years_of_experience}}</span></div>
            </div>
          </div>

          <!-- Address Section -->
          <div class="section">
            <div class="header">
              <span class="section-title">Address</span>
              <button type="button" class="edit-btn" onclick="editSection(this, ['address', 'postal'])">Edit âœŽ</button>
            </div>
            <div class="profile-details">
              <div class="detail-item"><span class="label">Address:</span><span class="value" id="address">
                  {{profile.address}}</span></div>
              <div class="detail-item"><span class="label">Postal Code:</span><span class="value"
                  id="postal">{{profile.postal_code}}</span>
              </div>
            </div>
          </div>

        </div>
        </form>

      </div>
     

    </main>
    <footer class="bg-body-tertiary text-center">
      <div class="rights text-center p-3">
        &copy; 2024 Nitte Meenakshi Institute Of Technology. All Rights Reserved.
      </div>
    </footer>
  </div>

  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
  <script>

  </script>
  <script src="/bus-incharge/js/notification.js"></script>
  <script src="/bus-incharge/js/profile.js"></script>
</body>

</html>
